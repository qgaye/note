# final关键字

## 修饰变量

被final修饰的变量表示一旦被赋值就不会再被改变

final instance variable (类中final变量)：必须在变量声明时，构造函数中，初始化代码块三者中一处初始化
final static variable (类中static final变量)：必须在变量声明时或静态初始化代码块中初始化
final local variable (方法中final变量)：只要在使用前初始化即可，和普通变量类似

注意：final修饰的变量对象，仅仅代表这个对象的引用不能被修改，但对象本身的属性是可以被修改的，除非认为人为使外部无法修改该对象的属性值(比如final修饰属性或不提供set方法)

## 修饰方法

构造方法不允许final修饰

被final修饰的普通方法在子类中不能被重写(即使只是重名方法也不可，因为Java中重名就代表重写)

被final修饰的静态方法在子类中不允许出现同名的静态方法(static方法属于类而不是对象，本来子类和父类中允许同名的静态方法，但它们不是重写而是仅仅代表着两个方法，它们分别通过各自的类调用)

## 修饰类

被final修饰的类不可被继承

final类的成员变量可以根据需要设为final，而所有的方法都会被隐式地指定为final

## final与String

string + 基本类型/常量，JVM会当成常量表达式直接求值来优化的(即优化为`"" + ""`的形式)

```java
final String s1 = "aaa";
String s2 = "aaabbb";
String s3 = s1 + "bbb"; // 优化为"aaa" + "bbb"形式
s2 == s3 // true
```

## final与重排序

1. 保证在构造函数中为final属性的赋值语句不会被重排序到构造函数外
2. 保证在构造函数中为final属性引用的具体对象的赋值语句不会重排序到构造函数外(即final对象是个对象引用，对该引用处的对象的赋值是不会被重排序到构造函数外)
